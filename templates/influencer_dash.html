<!DOCTYPE html>
<html lang="en">

<head>

  <title>Influencer Dashboard</title>
  <link rel="stylesheet" href="../static/dashboard.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

</head>

<body>
  <div id="main">
    <div id="canvas">
      <div id="dashboard-body">
        <!-- nav bar for influencer dashboard -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
          <div class="container-fluid">
            <label style="margin-right: 15px;">Welcome {{influencer.user_name}}</label>
            <!--<a class="navbar-brand" href="#">My Dashboard</a>-->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
              data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
              aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                  <button type="button" class="btn btn-outline-info" style=" margin-right: 10px;">Update
                    Profile</button>
                </li>
              </ul>
              <form class="d-flex" style="margin-right: 10px;">
                <input class="form-control me-2" type="search" placeholder="Search Campaign" aria-label="Search">
                <button class="btn btn-outline-success" type="submit">Search</button>
              </form>
              <form class="d-flex">
                <button class="btn btn-outline-danger" type="button"
                  onclick="location.href= '/userlogin'">Logout</button>
              </form>

            </div>
          </div>
        </nav>
        <!--profile pic-->
        <div style="display: flex; align-items: center;">
          <img src="/static/profile.png" alt="profile pic" width="200px">
          <div style="margin-left: 20px;">
            <p>Followers : 10k</p>
            <p>Niche : Entertainment</p>
            <p>Earnings $5k</p>
          </div>
        </div>

        <!--New Ad Request-->
        <h5>New Ad Requests</h5>
        <div class="container mt-4">
            {% if ad_requests %}
            <table class="table table-bordered table-striped">
                <thead>
                    <tr style="text-align: center;">
                        <th scope="col">S.No.</th>
                        <th scope="col">Campaign</th>
                        <th scope="col">Requirements</th>
                        <th scope="col">Payment Amount</th>
                        <th scope="col">Status</th>
                        <th scope="col">End_date</th>
                        <th scope="col">Action</th>
                    </tr>
                </thead>
                <tbody style="text-align: center;">
                    {% for req in ad_requests %}
                    <tr>
                        <th scope="row">{{ loop.index }}</th>
                        <td>{{ req.campaign.camp_name }}</td>
                        <td>{{ req.requirements }}</td>
                        <td>{{ req.payment_amt }}</td>
                        <td>{{ req.status }}</td>
                        <td>{{ req.end_date }}</td>
                        <td>
                            <button type="button" class="btn btn-success" style="margin-right: 10px;">Accept</button>
                        
                            <form action="'/influencer{{inluencer.influencer_id}}/ad_request{{ad_request.req_id}}'" method="POST"
                              onsubmit="return confirm('Are you sure you want to reject this ad_request?');">
                              <input type="hidden" name="_method" value="REJECT">
                              <button type="submit" class="btn btn-danger" >Reject</button>
                            </form>
                        </td>
                    </tr>
                    {% if req.is_accepted %}
                    <strong>Accepted</strong>
                    {% else %}
                    <strong>Pending</strong>
                    {% endif %}
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p>No ad requests found.</p>
            {% endif %}
        </div>

      <!--Influencer's current or active campaigns-->
      <h5>My Engagements</h5>
      <div class="container mt-4">
          {% if ad_requests %}
          <table class="table table-bordered table-striped">
              <thead>
                  <tr style="text-align: center;">
                      <th scope="col">S.No.</th>
                      <th scope="col">Campaign</th>
                      <th scope="col">To do</th>
                      <th scope="col">Status</th>
                      <th scope="col">Expires</th>
                      
                  </tr>
              </thead>
              <tbody style="text-align: center;">
                  {% for req in ad_requests %}>
                  {% if req.status == 'accepted' %}
                  {% set is_accepted = true %}
                  <tr>
                      <th scope="row">{{ loop.index }}</th>
                      <td>{{ req.campaign.camp_name }}</td>
                      <td>{{ req.requirements }}</td>
                      <td>active</td>   <!-- active status for accepted requests-->
                      <td>{{ req.end_date }}</td>
            
                  </tr>
                
                  {% endif %}
                  {% endfor %}
              </tbody>
          </table>
          {% if not is_accepted %}
          <p> No activity found</p>
          {% endif %}
          {% else %}
          <p>No activity found. <p>
          {% endif %}
      </div>



      </div>
    </div>
  </div>

</body>

</html>